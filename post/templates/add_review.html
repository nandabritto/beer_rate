{% extends 'base.html' %}

{% block content %}


{% if error_message %}
<div class="alert alert-warning alert-dismissible fade show" role="alert" id="alert">
    <p><strong>{{ error_message }} </strong></p>{% endif %}
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
</div>


<div class="container mt-5">

    <div class="bg-dark bg-opacity-50 col-lg-9 col-11 m-auto rounded">
        <h1 class="text-light text-center bold p-3"> Add your beer review</h1>
        <div class="text-light">
            <form method="POST">
                {% csrf_token %}
                Beer Style: {{ form.beer_style}} 
                <div class="row">
                    <div class="col-12 mb-3">
                      <button id="create-beer-style-sync" class="btn btn-primary" type="button" name="button">
                        <span class="fa fa-plus mr-2"></span>Create beer_style
                      </button>
                  
                
                
                <br /><br />
                Beer : {{ form.beer}}<br /><br />
                Write your review: {{ form.review}}<br /><br />

                Bitterness: {{ form.bitterness}} &nbsp;| &nbsp; Money Value : {{ form.money_value}}
                | &nbsp; Add your beer picture : {{form.beer_image}}

                <div class="text-center p-4">
                    <input type="submit" value="Save your review"
                        class="btn btn-secondary btn-success login-button btn-lg ">
                </div>
            </form>
        </div>
    </div>
</div>



{% endblock content %}


{% block extrascripts %}

<script type="text/javascript">
    $(function () {
       
        // Create book synchronous
        function createBeerStyleSyncModalForm() {
          $("#create-style-sync").modalForm({
              formURL: "{% url 'create_style' %}",
              modalID: "#create-modal"
          });
        }
        createBeerstyleSyncModalForm();

        // Create book asynchronous button
        // message
        var asyncSuccessMessageCreate = [
          "<div ",
          "style='position:fixed;top:0;z-index:10000;width:100%;border-radius:0;' ",
          "class='alert alert-icon alert-success alert-dismissible fade show mb-0' role='alert'>",
          "Success: Beer Style was created.",
          "<button type='button' class='close' data-dismiss='alert' aria-label='Close'>",
          "<span aria-hidden='true'>&times;</span>",
          "</button>",
          "</div>",
          "<script>",
          "$('.alert').fadeTo(2000, 500).slideUp(500, function () {$('.alert').slideUp(500).remove();});",
          "<\/script>"
        ].join("");

        // modal form
        function createBeerStyleAsyncModalForm() {
          $("#create-style-async").modalForm({
              formURL: "{% url 'create_style' %}",
              modalID: "#create-modal",
              asyncUpdate: true,
              asyncSettings: {
                closeOnSubmit: true,
                successMessage: asyncSuccessMessageCreate,
                dataUrl: "add_review/",
                dataElementId: "#style-table",
                dataKey: "table",
                addModalFormFunction: reinstantiateModalForms
              }
          });
        }
        createBookAsyncModalForm();

        

        function reinstantiateModalForms() {
          createBookAsyncModalForm();
        
        }

        // Filter books button
        $("#filter-book").each(function () {
            $(this).modalForm({formURL: $(this).data("form-url")});
        });

        // Hide message
        $(".alert").fadeTo(2000, 500).slideUp(500, function () {
            $(".alert").slideUp(500);
        });
    });
</script>


{% endblock extrascripts %}
